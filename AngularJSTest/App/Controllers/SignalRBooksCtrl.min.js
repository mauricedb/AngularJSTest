var App;(function(n){var t=function(){function n(n){this.$scope=n;var i=this,t=$;this.booksHub=t.connection.booksHub,t.connection.hub.start(function(){i.booksHub.server.getBooks().then(function(t){n.$apply(function(){n.books=t})})}),this.booksHub.client.bookUpdated=angular.bind(this,this.bookUpdated),n.select=angular.bind(this,this.select),n.addNew=angular.bind(this,this.addNew),n.save=angular.bind(this,this.save)}return n.$inject=["$scope"],n.prototype.select=function(n){this.$scope.selected=n},n.prototype.save=function(n){n.id?this.booksHub.server.updateBook(n):this.booksHub.server.addBook(n)},n.prototype.reset=function(n,t){var f=this.$scope,i,r,u;$("form[name="+n+"], form[name="+n+"] .ng-dirty").removeClass("ng-dirty").addClass("ng-pristine"),i=f[n],i.$dirty=!1,i.$pristine=!0;for(r in i)i[r].$pristine===!1&&(i[r].$pristine=!0),i[r].$dirty===!0&&(i[r].$dirty=!1);for(u in t)f[u]=t[u]},n.prototype.bookUpdated=function(n){var t=this;this.$scope.$apply(function(){var i=t.findBook(n.id);i?angular.extend(i,n):t.$scope.books.push(n)})},n.prototype.findBook=function(n){return this.$scope.books.reduce(function(t,i){return i.id===n&&(t=i),t},null)},n.prototype.addNew=function(n){this.reset(n),this.$scope.selected={id:0,title:"",author:""}},n}();n.SignalRBooksCtrl=t})(App||(App={}))
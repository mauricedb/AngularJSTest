var App;(function(n){var t=function(){function n(n,t){this.$scope=n,this.ctrlUtils=t;var i=this,r=$;this.booksHub=r.connection.booksHub,r.connection.hub.start(function(){i.booksHub.server.getBooks().then(function(t){n.$apply(function(){n.books=t,i.select(t[0])})})}),this.booksHub.client.bookUpdated=angular.bind(this,this.bookUpdated),n.select=angular.bind(this,this.select),n.addNew=angular.bind(this,this.addNew),n.save=angular.bind(this,this.save)}return n.$inject=["$scope","ctrlUtils"],n.prototype.select=function(n,t){t&&this.ctrlUtils.reset(this.$scope,t),this.$scope.selected=angular.extend({},n)},n.prototype.save=function(n,t){this.ctrlUtils.reset(this.$scope,t),n.id?this.booksHub.server.updateBook(n):this.booksHub.server.addBook(n)},n.prototype.bookUpdated=function(n){var t=this;this.$scope.$apply(function(){var i=t.findBook(n.id);i?angular.extend(i,n):t.$scope.books.push(n)})},n.prototype.findBook=function(n){return this.$scope.books.reduce(function(t,i){return i.id===n&&(t=i),t},null)},n.prototype.addNew=function(n){this.ctrlUtils.reset(this.$scope,n),this.$scope.selected={id:0,title:"",author:""}},n}();n.SignalRBooksCtrl=t})(App||(App={}))
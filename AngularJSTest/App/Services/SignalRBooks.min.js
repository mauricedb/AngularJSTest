var appBooks=angular.module("app.SignalRBooks",[]);appBooks.factory("SignalRBooks",function(n){function u(u){return r.connection.hub.start(function(){t.server.getBooks().then(function(t){angular.copy(t,i),u&&u(),n.$apply()})}),i}function f(n){n.id?t.server.updateBook(n):t.server.addBook(n)}function e(n){return i.reduce(function(t,i){return i.id===n&&(t=i),t},null)}var r=$,t=r.connection.booksHub,i=[];return t.client.bookUpdated=function(t){var r=e(t.id);r?angular.copy(t,r):i.push(t),n.$apply()},{getBooks:u,save:f}})
var appBooks=angular.module("app.SignalRBooks",[]);appBooks.factory("SignalRBooks",function(n){function r(r){return $.connection.hub.start(function(){t.server.getBooks().then(function(t){angular.copy(t,i),r&&r(),n.$apply()})}),i}function u(n){n.id?t.server.updateBook(n):t.server.addBook(n)}function f(n){return i.reduce(function(t,i){return i.id===n&&(t=i),t},null)}var t=$.connection.booksHub,i=[];return t.client.bookUpdated=function(t){var r=f(t.id);r?angular.copy(t,r):i.push(t),n.$apply()},{getBooks:r,save:u}})